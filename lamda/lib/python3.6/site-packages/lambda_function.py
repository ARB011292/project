import boto3
import textract


def lambda_handler(event, context):
    """Read file from s3 on trigger."""
    s3 = boto3.client("s3")
    if event:
        file_obj = event["Records"][0]
        bucketname = str(file_obj['s3']['bucket']['name'])
        filename = str(file_obj['s3']['object']['key'])
        path = '/tmp/'+filename
        s3.download_file(bucketname,filename,path)
        #text = textract.process(path)
        text = 'testtest'
        print(text)
        with open('/tmp/text.txt','w') as f:
            f.write(text)
    bucket_name = "processedresumebucket"
    file_name = "/tmp/text.txt"
    s3_path = "/100001/20180223/" + file_name
    response = s3.upload_file(file_name,bucket_name,file_name)
    return "Success"
